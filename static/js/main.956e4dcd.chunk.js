(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(t,e,a){},129:function(t,e,a){"use strict";a.r(e);var n=a(1),i=a.n(n),o=a(16),r=a.n(o),s=(a(88),a(89),a(78)),l=a(21),h=a(4),c=a(5),_=a(2),d=a(3),u=a(0),m=a(75),g=a(76),v=a(77),p=function(t){var e=null;for(var a in t){if("properties"===a)break;var n=t[a];if(t.properties[n].bIsDefault)return n;(null==e||n<e)&&(e=n)}return e},f=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=(e-t)/2;return t+i+Math.sin(n*a)*i},w=function(t,e,a,n,i){var o=t.distanceTo(e),r=Math.pow(o,2)-(Math.pow(n,2)-Math.pow(a,2)),s=2*a*(t.z-e.z),l=2*a*(Math.cos(i)*(t.x-e.x)+Math.sin(i)*(t.y-e.y));return Math.asin(r/Math.sqrt(Math.pow(s,2)+Math.pow(l,2)))-Math.atan(l/s)},C=new u.N(0,1,0),y={dist_plat_ball_joint_lat:35.6235,dist_plat_ball_joint_long:-29.9974,dist_plat_ball_joint_vert:0,dist_plat_stand_anchor_long:-8.636,dist_plat_stand_anchor_lat:0,dist_plat_stand_anchor_vert:-47.4726,dist_servo_pitch_roll_vert:-28.2194,dist_servo_pitch_roll_long:-29.9974,dist_servo_pitch_roll_lat:10.7442,mount_angle_servo_pitch_roll:0,length_servo_horn_pitch_roll:24.8793,length_connecting_rod_pitch_roll:28.2194,dist_servo_yaw_long:5.461,dist_servo_yaw_lat:-25.2222,dist_servo_yaw_vert:-47.4726,mount_angle_servo_yaw:Math.PI/2,length_servo_horn_yaw:14.097,length_connecting_rod_yaw:25.2222},b=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(t){var n;return Object(_.a)(this,a),(n=e.call(this))._parameters=void 0===t?y:t,n._base=new R,n._servo_PitchRoll_left=new k(n._parameters.length_servo_horn_pitch_roll),n._servo_PitchRoll_right=new k(n._parameters.length_servo_horn_pitch_roll),n._servo_Yaw=new k(n._parameters.length_servo_horn_yaw),n._platformStand=new P(n._parameters.dist_plat_stand_anchor_long,n._parameters.dist_plat_stand_anchor_lat,n._parameters.dist_plat_stand_anchor_vert),n._platform=new O(n._parameters.dist_plat_ball_joint_long,n._parameters.dist_plat_ball_joint_lat,n._parameters.dist_plat_ball_joint_vert),n._platformStand.add(n._platform),n._platformStand.position.set(0,0,0),n._base.add(n._platformStand),n._servo_Yaw.position.set(n._parameters.dist_servo_yaw_lat,n._parameters.dist_servo_yaw_vert,n._parameters.dist_servo_yaw_long),n._servo_Yaw.rotateY(n._parameters.mount_angle_servo_yaw),n._base.add(n._servo_Yaw),n._servo_PitchRoll_left.position.set(n._parameters.dist_servo_pitch_roll_lat,n._parameters.dist_servo_pitch_roll_vert,n._parameters.dist_servo_pitch_roll_long),n._servo_PitchRoll_left.rotateX(Math.PI/2),n._servo_PitchRoll_left.rotateY(-Math.PI/2),n._servo_PitchRoll_left.rotateX(n._parameters.mount_angle_servo_pitch_roll),n._base.add(n._servo_PitchRoll_left),n._servo_PitchRoll_right.position.set(-n._parameters.dist_servo_pitch_roll_lat,n._parameters.dist_servo_pitch_roll_vert,n._parameters.dist_servo_pitch_roll_long),n._servo_PitchRoll_right.rotateX(Math.PI/2),n._servo_PitchRoll_right.rotateY(-Math.PI/2),n._servo_PitchRoll_right.rotateX(-n._parameters.mount_angle_servo_pitch_roll),n._base.add(n._servo_PitchRoll_right),n.add(n._base),n.updateMatrixWorld(),n._clock=new u.f,n}return Object(d.a)(a,[{key:"getPlatform",value:function(){return this._platform}},{key:"getPlatformStand",value:function(){return this._platformStand}},{key:"getBase",value:function(){return this._base}},{key:"getServoPitchRollLeft",value:function(){return this._servo_PitchRoll_left}},{key:"getServoPitchRollRight",value:function(){return this._servo_PitchRoll_right}},{key:"getServoYaw",value:function(){return this._servo_Yaw}},{key:"getYawConnectingRodLength",value:function(){return this.getServoYaw().getHorn().getBallJoint().getWorldPosition(new u.N).distanceTo(this._platformStand.getBallJoint().getWorldPosition(new u.N))}},{key:"getYawConnectingRodMidPoint_WorldPosition",value:function(){return E(this.getServoYaw().getHorn().getBallJoint().getWorldPosition(new u.N),this._platformStand.getBallJoint().getWorldPosition(new u.N),.5)}},{key:"getConnectingRodLength_Left",value:function(){return this.getServoPitchRollLeft().getHorn().getBallJoint().getWorldPosition(new u.N).distanceTo(this.getPlatform().getBallJointLeft().getWorldPosition(new u.N))}},{key:"getConnectingRodLength_Right",value:function(){return this.getServoPitchRollRight().getHorn().getBallJoint().getWorldPosition(new u.N).distanceTo(this.getPlatform().getBallJointRight().getWorldPosition(new u.N))}},{key:"getConnectingRodMidPoint_Left_WorldPosition",value:function(){return E(this.getServoPitchRollLeft().getHorn().getBallJoint().getWorldPosition(new u.N),this.getPlatform().getBallJointLeft().getWorldPosition(new u.N),.5)}},{key:"getConnectingRodMidPoint_Right_WorldPosition",value:function(){return E(this.getServoPitchRollRight().getHorn().getBallJoint().getWorldPosition(new u.N),this.getPlatform().getBallJointRight().getWorldPosition(new u.N),.5)}},{key:"getQVec_Left",value:function(){return this.getBase().worldToLocal(this.getPlatform().getBallJointLeft().getWorldPosition(new u.N))}},{key:"getQVec_Right",value:function(){return this.getBase().worldToLocal(this.getPlatform().getBallJointRight().getWorldPosition(new u.N))}},{key:"getBVec_Left",value:function(){return this.getBase().worldToLocal(this.getServoPitchRollLeft().getHorn().getWorldPosition(new u.N))}},{key:"getBVec_Right",value:function(){return this.getBase().worldToLocal(this.getServoPitchRollRight().getHorn().getWorldPosition(new u.N))}},{key:"getServoAngle_Left",value:function(){var t=this.getQVec_Left(),e=this.getBVec_Left(),a=this._parameters.length_servo_horn_pitch_roll,n=this._parameters.length_connecting_rod_pitch_roll,i=Math.PI+this._parameters.mount_angle_servo_pitch_roll;return Math.PI+w(new u.N(-t.x,t.z,t.y),new u.N(-e.x,e.z,e.y),a,n,i)}},{key:"getServoAngle_Right",value:function(){var t=this.getQVec_Right(),e=this.getBVec_Right(),a=this._parameters.length_servo_horn_pitch_roll,n=this._parameters.length_connecting_rod_pitch_roll,i=Math.PI-this._parameters.mount_angle_servo_pitch_roll;return-w(new u.N(t.x,t.z,t.y),new u.N(e.x,e.z,e.y),a,n,i)}},{key:"getYawServoAngle",value:function(){var t=this._parameters.length_servo_horn_yaw,e=this._parameters.length_connecting_rod_yaw,a=this.getPlatformStand().getBallJoint().getWorldPosition(new u.N),n=this.getServoYaw().getHorn().getWorldPosition(new u.N),i=new u.N;return i.subVectors(a,n),function(t,e,a){var n=[],i=Math.acos((t.x*t.x+t.y*t.y-e*e-a*a)/(2*e*a)),o=Math.atan(t.y/t.x)-Math.atan(a*Math.sin(i)/(e+a*Math.cos(i)));return n.push({q1:o,q2:i}),i=-i,o=Math.atan(t.y/t.x)+Math.atan(a*Math.sin(i)/(e+a*Math.cos(i))),n.push({q1:o,q2:i}),n}(i=new u.M(-i.z,-i.x),t,e)[0].q2}},{key:"updateServos",value:function(){this.getServoPitchRollLeft().getHorn().setRotationFromAxisAngle(C,this.getServoAngle_Left()),this.getServoPitchRollLeft().getHorn().getBallJoint().lookAt(this.getPlatform().getBallJointLeft().getWorldPosition(new u.N)),this.getServoPitchRollRight().getHorn().setRotationFromAxisAngle(C,this.getServoAngle_Right()),this.getServoPitchRollRight().getHorn().getBallJoint().lookAt(this.getPlatform().getBallJointRight().getWorldPosition(new u.N)),this.getServoYaw().getHorn().setRotationFromAxisAngle(C,this.getYawServoAngle()),this.getServoYaw().getHorn().getBallJoint().lookAt(this.getPlatformStand().getBallJoint().getWorldPosition(new u.N))}},{key:"simulateMotion",value:function(){var t=this._clock.getElapsedTime(),e=Math.PI/10,a=Math.PI/20,n=Math.PI/30;this.setFinalOrientation(f(e,-e,t,.5),f(a,-a,.5*t,.5),f(n,-n,t,5))}},{key:"setFinalOrientation",value:function(t,e,a){this.getPlatformStand().setRotationFromAxisAngle(C,t),this.getPlatformStand().getBallJoint().lookAt(this.getServoYaw().getHorn().getBallJoint().getWorldPosition(new u.N)),this.getPlatform().setRotationFromEuler(new u.k(e,0,a,"XYZ")),this.getPlatform().getBallJointLeft().lookAt(this.getServoPitchRollLeft().getHorn().getBallJoint().getWorldPosition(new u.N)),this.getPlatform().getBallJointRight().lookAt(this.getServoPitchRollRight().getHorn().getBallJoint().getWorldPosition(new u.N))}},{key:"trackTarget",value:function(t){var e=this.getPlatform().getWorldPosition(new u.N),a=(new u.k).setFromRotationMatrix((new u.w).lookAt(e,t,C));this.setFinalOrientation(-a.y,Math.PI+a.x,Math.PI+a.z)}},{key:"animate",value:function(){this.updateServos()}}]),a}(u.p),R=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(){return Object(_.a)(this,a),e.apply(this,arguments)}return a}(u.p),P=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(t,n,i){var o;return Object(_.a)(this,a),(o=e.call(this))._ballJoint=new S,o._ballJoint.position.set(n,i,t),o.add(o._ballJoint),o}return Object(d.a)(a,[{key:"getBallJoint",value:function(){return this._ballJoint}}]),a}(u.p),O=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(t,n,i){var o;return Object(_.a)(this,a),(o=e.call(this))._ballJoint_left=new S,o._ballJoint_left.position.set(n,i,t),o.add(o._ballJoint_left),o._ballJoint_right=new S,o._ballJoint_right.position.set(-n,i,t),o.add(o._ballJoint_right),o}return Object(d.a)(a,[{key:"getBallJointLeft",value:function(){return this._ballJoint_left}},{key:"getBallJointRight",value:function(){return this._ballJoint_right}}]),a}(u.p),k=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(t){var n;return Object(_.a)(this,a),(n=e.call(this))._horn=new M(t),n.add(n._horn),n}return Object(d.a)(a,[{key:"getHorn",value:function(){return this._horn}}]),a}(u.p),M=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(t){var n;return Object(_.a)(this,a),(n=e.call(this))._ballJoint=new S,n._ballJoint.position.set(0,0,t),n.add(n._ballJoint),n}return Object(d.a)(a,[{key:"getBallJoint",value:function(){return this._ballJoint}}]),a}(u.p),S=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(){return Object(_.a)(this,a),e.apply(this,arguments)}return a}(u.p);function E(t,e,a){var n=e.clone().sub(t),i=n.length();return n=n.normalize().multiplyScalar(i*a),t.clone().add(n)}var H=a(74);var B=new u.N(0,1,0),T=new u.N(0,0,1),L={PERSPECTIVE:1,ORTHO_TOP:2,ORTHO_BOTTOM:3,ORTHO_FRONT:4,ORTHO_BACK:5,ORTHO_LEFT:6,ORTHO_RIGHT:7,properties:{1:{value:1,name:"PERSPECTIVE",displayName:"Free Cam",bIsDefault:!0},2:{value:2,name:"ORTHO_TOP",displayName:"Top View"},3:{value:3,name:"ORTHO_BOTTOM",displayName:"Bottom View"},4:{value:4,name:"ORTHO_FRONT",displayName:"Front View"},5:{value:5,name:"ORTHO_BACK",displayName:"Back View"},6:{value:6,name:"ORTHO_LEFT",displayName:"Left View"},7:{value:7,name:"ORTHO_RIGHT",displayName:"Right View"}}},N={DARK_BLUE:1,GREY:2,WHITE:3,WARM:4,properties:{1:{value:1,name:"DARK_BLUE",color:1383461,displayName:"Dark Blue",bIsDefault:!1,textOverlayColor:{r:255,g:255,b:255,a:1}},2:{value:2,name:"GREY",color:11579568,displayName:"Grey",bIsDefault:!1,textOverlayColor:{r:0,g:0,b:0,a:1}},3:{value:3,name:"WHITE",color:16777215,displayName:"White",bIsDefault:!1,textOverlayColor:{r:0,g:0,b:0,a:1}},4:{value:4,name:"WARM",color:7496795,displayName:"Warm",bIsDefault:!0,textOverlayColor:{r:0,g:0,b:0,a:1}}}},j=function(){function t(e,a){Object(_.a)(this,t),this.cameraManager=e,this.renderer=a,this.controls=null,this.controlsMap={},this.bCameraControlsEnabled=!0}return Object(d.a)(t,[{key:"updateControlType",value:function(t){if(t in this.controlsMap||(t===L.PERSPECTIVE?(this.controlsMap[t]=new m.a(this.cameraManager.camera,this.renderer.domElement),this.controlsMap[t].enableKeys=!1):(this.controlsMap[t]=new g.a(this.cameraManager.camera,this.renderer.domElement),this.controlsMap[t].noRotate=!0,this.controlsMap[t].zoomSpeed=1.5,this.controlsMap[t].panSpeed=10,this.controlsMap[t].staticMoving=!0,this.controlsMap[t].dynamicDampingFactor=.3)),t===this.cameraManager.previousViewType)return this.controls.reset(),void(this.controls.enabled=this.bCameraControlsEnabled);this.controls=this.controlsMap[t],this.controls.reset();var e=this.cameraManager.previousViewType;e in this.controlsMap&&(this.controlsMap[e].enabled=!1),this.controls.enabled=this.bCameraControlsEnabled}},{key:"toggleCameraControls",value:function(){this.bCameraControlsEnabled=!this.bCameraControlsEnabled,this.controls.enabled=this.bCameraControlsEnabled}},{key:"setCameraControlsEnabled",value:function(t){this.bCameraControlsEnabled=t,this.controls.enabled=this.bCameraControlsEnabled}},{key:"updateControls",value:function(){this.controls.update()}}]),t}(),x=function(){function t(e,a){Object(_.a)(this,t),this.WIDTH=e,this.HEIGHT=a,this.camera=null,this.currentViewType=null,this.previousViewType=null,this.orthoCam=null,this.perspectiveCam=null,this.startingOrthoCamDistance=125,this.startingPerspectiveCamPosition=new u.N(125,50,70)}return Object(d.a)(t,[{key:"initCamera",value:function(){this.changeCamera(p(L))}},{key:"changeCamera",value:function(t){switch(t){case L.PERSPECTIVE:this.camera=this.getOrCreatePerspectiveCamera(),this.setCameraView(t);break;default:this.camera=this.getOrCreateOrthographicCamera(),this.setCameraView(t)}this.previousViewType=this.currentViewType,this.currentViewType=t}},{key:"setCameraView",value:function(t){switch(this.camera.rotation.set(0,0,0),t){case L.PERSPECTIVE:this.camera.position.copy(this.startingPerspectiveCamPosition);break;case L.ORTHO_FRONT:this.camera.position.set(0,0,this.startingOrthoCamDistance),this.camera.up=B;break;case L.ORTHO_BACK:this.camera.position.set(0,0,-this.startingOrthoCamDistance),this.camera.up=B;break;case L.ORTHO_LEFT:this.camera.position.set(-this.startingOrthoCamDistance,0,0),this.camera.up=B;break;case L.ORTHO_RIGHT:this.camera.position.set(this.startingOrthoCamDistance,0,0),this.camera.up=B;break;case L.ORTHO_TOP:this.camera.position.set(0,this.startingOrthoCamDistance,0),this.camera.up=T;break;case L.ORTHO_BOTTOM:this.camera.position.set(0,-this.startingOrthoCamDistance,0),this.camera.up=T;break;default:throw Error("Unexpected viewtype: ".concat(t,"."))}}},{key:"getOrCreatePerspectiveCamera",value:function(){if(!this.perspectiveCam){var t=this.WIDTH/this.HEIGHT;this.perspectiveCam=new u.D(90,t,.1,1e4)}return this.perspectiveCam}},{key:"getOrCreateOrthographicCamera",value:function(){return this.orthoCam||(this.orthoCam=new u.C(this.WIDTH/-2,this.WIDTH/2,this.HEIGHT/2,this.HEIGHT/-2,.1,1e4),this.orthoCam.zoom=12),this.orthoCam}},{key:"updateAspectRatio",value:function(t,e){this.WIDTH=t,this.HEIGHT=e,this.perspectiveCam&&(this.perspectiveCam.aspect=this.WIDTH/this.HEIGHT,this.perspectiveCam.updateProjectionMatrix()),this.orthoCam&&(this.orthoCam.left=this.WIDTH/-2,this.orthoCam.right=this.WIDTH/2,this.orthoCam.top=this.HEIGHT/2,this.orthoCam.bottom=this.HEIGHT/-2,this.orthoCam.updateProjectionMatrix())}}]),t}(),J=function(){function t(){Object(_.a)(this,t),this.currentBackgroundColor=p(N),this.distanceScale=1}return Object(d.a)(t,[{key:"getCurrentBackgroundColorValue",value:function(){return N.properties[this.currentBackgroundColor].color}},{key:"getDefaultBackgroundColorValue",value:function(){return N.properties[p(N)].color}},{key:"setBackgroundColor",value:function(t){this.currentBackgroundColor=t}}]),t}(),W=function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(){return Object(_.a)(this,a),e.call(this,new u.I(5,32,32),new u.y({color:16776960}))}return a}(u.x),I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new J;Object(_.a)(this,t),this._settings=e,this._width=null,this._height=null,this._scene=null,this._renderer=null,this._mount=null,this._cameraManager=null,this._cameraControlsManager=null,this._mechanism=null,this._target=null,this._animHooks=null,this._simulateMotion=!1}return Object(d.a)(t,[{key:"init",value:function(t){var e=this;window.addEventListener("resize",function(){return e.onCanvasResize()},!1),this._mount=t,this._width=this._mount.clientWidth,this._height=this._mount.clientHeight,this._scene=new u.H,this._renderer=new u.O,this._renderer.setClearColor(this._settings.getDefaultBackgroundColorValue()),this._renderer.setSize(this._width,this._height),this._mount.append(this._renderer.domElement),this._cameraManager=new x(this._width,this._height),this._cameraManager.initCamera(),this._scene.add(this._cameraManager.camera),this._cameraControlsManager=new j(this._cameraManager,this._renderer),this._cameraControlsManager.updateControlType(this._cameraManager.currentViewType);var a=new u.a(16777215);this._scene.add(a),this._scene.fog=new u.o(7496795,2,1500),this._scene.add(new u.q(4469555,1118498)),this.addShadowedLight(.5,1,-1,16755200,1);var n=new u.x(new u.E(1e4,1e4),new u.z({color:10066329,specular:1052688}));n.rotation.x=-Math.PI/2,n.position.y=-200,this._scene.add(n),n.receiveShadow=!0;var i=new u.b(250*this._settings.distanceScale);this._scene.add(i),this._target=new W,this._target.position.set(0,25,100),this._scene.add(this._target),this._transformControls=null,this._animHooks=[],this._mechanism=new b,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/3dof-stewart-simulator/models/wheatley/skeleton.stl",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/3dof-stewart-simulator/models/wheatley/yaw_rod.stl",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/3dof-stewart-simulator/models/wheatley/yaw_rod_mount.stl",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"/3dof-stewart-simulator/models/wheatley/center_platform.stl",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"/3dof-stewart-simulator/models/servo/s3003.stl",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"/3dof-stewart-simulator/models/servo/s3003.stl",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"/3dof-stewart-simulator/models/servo/s3003.stl",h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"/3dof-stewart-simulator/models/horn/MG90s_arm.stl",c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"/3dof-stewart-simulator/models/ball-joint/m3_ball_joint.stl",_=new H.a,d=new u.z({color:11184810,specular:1118481,shininess:200,opacity:.5,transparent:!0}),m=new u.y({color:4210752,opacity:.5,transparent:!0}),g=new u.y({color:16119285,opacity:.5,transparent:!0}),v=new u.y({color:3158064,opacity:.5,transparent:!0});_.load(e,function(e){var a=new u.x(e,d);a.rotation.set(-Math.PI/2,0,0),a.castShadow=!0,a.receiveShadow=!0,t.getBase().add(a)}),_.load(a,function(e){var a=new u.x(e,d);a.rotation.set(-Math.PI/2,0,0),t.getPlatformStand().add(a)}),_.load(n,function(e){var a=new u.x(e,d);a.rotation.set(-Math.PI/2,0,0),t.getPlatformStand().add(a)}),_.load(i,function(e){var a=new u.x(e,d);a.rotation.set(-Math.PI/2,0,0),t.getPlatform().add(a)});for(var p=function(){var t=Object(l.a)(w[f],2),e=t[0],a=t[1];_.load(a,function(t){var a=new u.x(t,m);e.add(a)}),_.load(h,function(t){var a=new u.x(t,g);a.rotation.set(Math.PI,0,0),e.getHorn().add(a)})},f=0,w=[[t.getServoPitchRollLeft(),o],[t.getServoPitchRollRight(),r],[t.getServoYaw(),s]];f<w.length;f++)p();for(var C=function(){var t=b[y];_.load(c,function(e){var a=new u.x(e,v);a.position.set(0,0,0),a.rotation.set(-Math.PI/2,0,0),a.scale.set(.15,.15,.15),t.add(a)})},y=0,b=[t.getPlatformStand().getBallJoint(),t.getServoPitchRollLeft().getHorn().getBallJoint(),t.getServoPitchRollRight().getHorn().getBallJoint(),t.getServoYaw().getHorn().getBallJoint(),t.getPlatformStand().getBallJoint(),t.getPlatform().getBallJointLeft(),t.getPlatform().getBallJointRight()];y<b.length;y++)C();t.getPlatform().add(new u.b(30)),t.getPlatformStand().add(new u.b(15));for(var R=0,P=[t.getServoPitchRollLeft(),t.getServoPitchRollRight(),t.getServoYaw()];R<P.length;R++){var O=P[R];O.add(new u.b(8)),O.getHorn().add(new u.b(8)),O.getHorn().getBallJoint().add(new u.b(5))}}(this._mechanism),this._scene.add(this._mechanism),this.animate(),this._mechanism.setFinalOrientation(0,0,0)}},{key:"addShadowedLight",value:function(t,e,a,n,i){var o=new u.i(n,i);o.position.set(t,e,a),this._scene.add(o),o.castShadow=!0;o.shadow.camera.left=-1,o.shadow.camera.right=1,o.shadow.camera.top=1,o.shadow.camera.bottom=-1,o.shadow.camera.near=1,o.shadow.camera.far=400,o.shadow.bias=-.002}},{key:"toggleMechanismSimulatedMotion",value:function(){this._simulateMotion=!this._simulateMotion}},{key:"resetMechanismOrientation",value:function(){void 0!==this._mechanism&&null!==this._mechanism&&this._mechanism.setFinalOrientation(0,0,0)}},{key:"addAnimHook",value:function(t){this._animHooks.push(t)}},{key:"activateTargetMode",value:function(){this.deactivateTargetMode(),this._cameraControlsManager.setCameraControlsEnabled(!1),this._transformControls=new v.a(this._cameraManager.camera,this._mount),this._transformControls.attach(this._target),this._scene.add(this._transformControls)}},{key:"deactivateTargetMode",value:function(){void 0!==this._transformControls&&null!==this._transformControls&&(this._transformControls.detach(),this._scene.remove(this._transformControls),this._transformControls.dispose(),this._transformControls=null,this._cameraControlsManager.setCameraControlsEnabled(!0))}},{key:"changeView",value:function(t){console.log(this._cameraManager.camera.position,this._cameraManager.camera.rotation),this._scene.remove(this._cameraManager.camera),this._cameraManager.changeCamera(t),this._scene.add(this._cameraManager.camera),this._cameraControlsManager.updateControlType(t)}},{key:"onCanvasResize",value:function(){this._width=this._mount.clientWidth,this._height=this._mount.clientHeight,this._cameraManager.updateAspectRatio(this._width,this._height),this._renderer.setSize(this._width,this._height)}},{key:"changeBackgroundColor",value:function(t){this._settings.setBackgroundColor(t),this.updateBackgroundColor()}},{key:"updateBackgroundColor",value:function(){var t=this._settings.getCurrentBackgroundColorValue();this._renderer.setClearColor(t)}},{key:"animate",value:function(){var t=this;requestAnimationFrame(function(){return t.animate()}),this._cameraControlsManager.bCameraControlsEnabled&&this._cameraControlsManager.updateControls(),this.animateMechanism(),this._animHooks.forEach(function(t){t.animate()}),this.render()}},{key:"animateMechanism",value:function(){null!=this._mechanism&&void 0!==this._mechanism&&(null==this._transformControls||void 0===this._transformControls?this._simulateMotion&&this._mechanism.simulateMotion():this._mechanism.trackTarget(this._target.getWorldPosition(new u.N)),this._mechanism.animate())}},{key:"render",value:function(){this._renderer.render(this._scene,this._cameraManager.camera)}}]),t}();function A(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"".concat(t.x.toFixed(e),",").concat(t.y.toFixed(e),",").concat(t.z.toFixed(e))}var Y=function(){function t(){Object(_.a)(this,t),this._isDisposed=!1,this._mount=null,this._visualizer=null,this._mechanism=null,this._dispServoLeft=null,this._dispServoHornLeft=null,this._dispPlatformAnchorLeft=null,this._dispConnectingRodLeft=null,this._dispServoRight=null,this._dispServoHornRight=null,this._dispPlatformAnchorRight=null,this._dispConnectingRodRight=null,this._dispServoYaw=null,this._dispServoHornYaw=null,this._dispPlatformStandAnchorYaw=null,this._dispConnectingRodYaw=null}return Object(d.a)(t,[{key:"dispose",value:function(){var t=this;this._isDisposed||(this._isDisposed=!0,[this._dispServoLeft,this._dispServoHornLeft,this._dispPlatformAnchorLeft,this._dispConnectingRodLeft,this._dispServoRight,this._dispServoHornRight,this._dispPlatformAnchorRight,this._dispConnectingRodRight,this._dispServoYaw,this._dispServoHornYaw,this._dispPlatformStandAnchorYaw,this._dispConnectingRodYaw].forEach(function(e){t._mount.removeChild(e),e.remove()}),this._dispServoLeft=null,this._dispServoHornLeft=null,this._dispPlatformAnchorLeft=null,this._dispConnectingRodLeft=null,this._dispServoRight=null,this._dispServoHornRight=null,this._dispPlatformAnchorRight=null,this._dispConnectingRodRight=null,this._dispServoYaw=null,this._dispServoHornYaw=null,this._dispPlatformStandAnchorYaw=null,this._dispConnectingRodYaw=null,this._mount=null,this._visualizer=null,this._mechanism=null)}},{key:"init",value:function(t,e){var a=this;this._isDisposed||(this._mount=t,this._visualizer=e,this._mechanism=e._mechanism,this._dispServoLeft=document.createElement("div"),this._dispServoHornLeft=document.createElement("div"),this._dispPlatformAnchorLeft=document.createElement("div"),this._dispConnectingRodLeft=document.createElement("div"),this._dispServoRight=document.createElement("div"),this._dispServoHornRight=document.createElement("div"),this._dispPlatformAnchorRight=document.createElement("div"),this._dispConnectingRodRight=document.createElement("div"),this._dispServoYaw=document.createElement("div"),this._dispServoHornYaw=document.createElement("div"),this._dispPlatformStandAnchorYaw=document.createElement("div"),this._dispConnectingRodYaw=document.createElement("div"),[this._dispServoLeft,this._dispServoHornLeft,this._dispPlatformAnchorLeft,this._dispConnectingRodLeft,this._dispServoRight,this._dispServoHornRight,this._dispPlatformAnchorRight,this._dispConnectingRodRight,this._dispServoYaw,this._dispServoHornYaw,this._dispPlatformStandAnchorYaw,this._dispConnectingRodYaw].forEach(function(t){t.textContent="placeholder",a._mount.appendChild(t)}))}},{key:"animate",value:function(){if(!this._isDisposed){this.updateElement(this._dispServoLeft,this._mechanism._servo_PitchRoll_left.getWorldPosition(new u.N),"Rotation: ".concat(this._mechanism.getServoAngle_Left().toFixed(2),"rad")),this.updateElement(this._dispServoRight,this._mechanism._servo_PitchRoll_right.getWorldPosition(new u.N),"Rotation: ".concat(this._mechanism.getServoAngle_Right().toFixed(2),"rad")),this.updateElement(this._dispConnectingRodLeft,this._mechanism.getConnectingRodMidPoint_Left_WorldPosition(),"Len: ".concat(this._mechanism.getConnectingRodLength_Left().toFixed(2))),this.updateElement(this._dispConnectingRodRight,this._mechanism.getConnectingRodMidPoint_Right_WorldPosition(),"Len: ".concat(this._mechanism.getConnectingRodLength_Right().toFixed(2)));var t=this._mechanism._servo_PitchRoll_left.getHorn().getBallJoint().getWorldPosition(new u.N);this.updateElement(this._dispServoHornLeft,t,A(t));var e=this._mechanism._servo_PitchRoll_right.getHorn().getBallJoint().getWorldPosition(new u.N);this.updateElement(this._dispServoHornRight,e,A(e));var a=this._mechanism._platform.getBallJointLeft().getWorldPosition(new u.N);this.updateElement(this._dispPlatformAnchorLeft,a,A(a));var n=this._mechanism._platform.getBallJointRight().getWorldPosition(new u.N);this.updateElement(this._dispPlatformAnchorRight,n,A(n)),this.updateElement(this._dispServoYaw,this._mechanism._servo_Yaw.getWorldPosition(new u.N),"Rotation: ".concat(this._mechanism.getYawServoAngle().toFixed(2),"rad")),this.updateElement(this._dispConnectingRodYaw,this._mechanism.getYawConnectingRodMidPoint_WorldPosition(),"Len: ".concat(this._mechanism.getYawConnectingRodLength().toFixed(2)));var i=this._mechanism._servo_Yaw.getHorn().getBallJoint().getWorldPosition(new u.N);this.updateElement(this._dispServoHornYaw,i,A(i));var o=this._mechanism._platformStand.getBallJoint().getWorldPosition(new u.N);this.updateElement(this._dispPlatformStandAnchorYaw,o,A(o))}}},{key:"updateElement",value:function(t,e,a){e.project(this._visualizer._cameraManager.camera);var n=(.5*e.x+.5)*this._visualizer._width,i=(-.5*e.y+.5)*this._visualizer._height;t.style.transform="translate(-50%, -50%) translate(".concat(n,"px,").concat(i,"px)"),t.textContent=a}}]),t}(),z=function(){function t(){Object(_.a)(this,t),this._mount=null,this._visualizer=null,this._componentsByName=[]}return Object(d.a)(t,[{key:"init",value:function(t,e){this._mount=t,this._visualizer=e,this.animate()}},{key:"hasComponent",value:function(t){return t in this._componentsByName}},{key:"addOrReplaceHUDComponentByName",value:function(t,e){this.removeHudComponentByName(t),e.init(this._mount,this._visualizer),this._componentsByName[t]=e}},{key:"removeHudComponentByName",value:function(t){this.hasComponent(t)&&(this._componentsByName[t].dispose(),delete this._componentsByName[t])}},{key:"animate",value:function(){for(var t=0,e=Object.entries(this._componentsByName);t<e.length;t++){var a=Object(l.a)(e[t],2);a[0];a[1].animate()}}}]),t}(),D=i.a.createContext(),V=i.a.createContext();function F(t,e){switch(e.type){case"init":return t.visualizer.init(e.visualizerMount),t.debugHUD.init(e.hudMount,t.visualizer),t.visualizer.addAnimHook(t.debugHUD),t;case"change_view":return t.visualizer.changeView(e.view),t;case"change_background_color":return t.visualizer.changeBackgroundColor(e.color),t;case"activate_target_control":return t.visualizer.activateTargetMode(),t;case"deactivate_target_control":return t.visualizer.deactivateTargetMode(),t;case"toggle_debug_info":return t.debugHUD.hasComponent("debug")?t.debugHUD.removeHudComponentByName("debug"):t.debugHUD.addOrReplaceHUDComponentByName("debug",new Y),t;default:throw new Error("Unhandled action type: ".concat(e.type))}}function G(t){var e=t.children,a=i.a.useReducer(F,{visualizer:new I,debugHUD:new z}),n=Object(l.a)(a,2),o=n[0],r=n[1];return i.a.createElement(D.Provider,{value:o},i.a.createElement(V.Provider,{value:r},e))}var U=function(){var t=Object(n.useContext)(V),e=Object(n.useContext)(D);return i.a.createElement("div",null,i.a.createElement("h1",null,"Settings..."),i.a.createElement(s.a,{variant:"primary",size:"lg",block:!0,onClick:function(){t({type:"toggle_debug_info"})}},"Toggle Debug HUD"),i.a.createElement(s.a,{variant:"primary",size:"lg",block:!0,onClick:function(){e.visualizer.toggleMechanismSimulatedMotion()}},"Toggle Simulated Motion"),i.a.createElement(s.a,{variant:"primary",size:"lg",block:!0,onClick:function(){e.visualizer.resetMechanismOrientation()}},"Reset Orientation"))},K=a(137),q=a(131);var X=function(){return i.a.createElement("div",null,i.a.createElement(K.a,{defaultActiveKey:"settings",id:"uncontrolled-tab-example"},i.a.createElement(q.a,{eventKey:"settings",title:"Settings"},i.a.createElement(U,null)),i.a.createElement(q.a,{eventKey:"disabled_example",title:"Disabled",disabled:!0},"Disabled example text...")))},Q=(a(103),function(t){Object(h.a)(a,t);var e=Object(c.a)(a);function a(){return Object(_.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){(0,this.context)({type:"init",visualizerMount:this.visualizerMount,hudMount:this.hudMount})}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"Visualizer-window",ref:function(e){t.visualizerMount=e}},i.a.createElement("div",{id:"debug-hud",ref:function(e){t.hudMount=e}}))}}]),a}(i.a.Component));Q.contextType=V;var Z=Q,$=a(135),tt=a(136),et=a(82);function at(){var t=Object(n.useContext)(V);return i.a.createElement($.a,{title:"Camera View",id:"basic-nav-dropdown"},Object.keys(L.properties).map(function(e,a){return i.a.createElement($.a.Item,{key:a,onClick:function(){return t({type:"change_view",view:L.properties[e].value})}},L.properties[e].displayName)}))}function nt(){var t=Object(n.useContext)(V);return i.a.createElement($.a,{title:"Background Color",id:"basic-nav-dropdown"},Object.keys(N.properties).map(function(e,a){return i.a.createElement($.a.Item,{key:a,onClick:function(){return t({type:"change_background_color",color:N.properties[e].value})}},N.properties[e].displayName)}))}function it(){var t=Object(n.useContext)(V);return i.a.createElement($.a,{title:"Target Control",id:"basic-nav-dropdown"},i.a.createElement($.a.Item,{onClick:function(){return t({type:"deactivate_target_control"})}},"Off"),i.a.createElement($.a.Item,{onClick:function(){return t({type:"activate_target_control"})}},"On"))}var ot=function(){return i.a.createElement(tt.a,{bg:"light",expand:"lg"},i.a.createElement(tt.a.Brand,null,"Stewart Simulator"),i.a.createElement(tt.a.Toggle,{"aria-controls":"basic-navbar-nav"}),i.a.createElement(tt.a.Collapse,{id:"basic-navbar-nav"},i.a.createElement(et.a,{className:"mr-auto"},i.a.createElement(at,null),i.a.createElement(nt,null),i.a.createElement(it,null))))},rt=a(132),st=a(133),lt=a(134);var ht=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(G,null,i.a.createElement(rt.a,{fluid:!0},i.a.createElement(st.a,null,i.a.createElement(lt.a,null,i.a.createElement(X,null)),i.a.createElement(lt.a,{xs:9},i.a.createElement(ot,null),i.a.createElement(Z,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(128);r.a.render(i.a.createElement(ht,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},83:function(t,e,a){t.exports=a(129)},88:function(t,e,a){},89:function(t,e,a){}},[[83,1,2]]]);
//# sourceMappingURL=main.956e4dcd.chunk.js.map